import{r as i,h as t}from"./p-63ebe09a.js";class s extends Error{}const n=class{constructor(t){i(this,t);this.apiURL="https://business-api.parcellab.com/v3/public/campaign/contentBlocks";this.medium="web";this.contentType="banner_order_status_page";this.bannerType="mainBannerVertical";this.language=undefined;this.trackingId=undefined;this._campaign=undefined;this.bannerSrc=undefined;this.targetUrl=undefined;this.fetchBanner().catch(console.warn)}getTrackingPropsFromURL(){const i=new URLSearchParams(window.location.search);const t=i.get("xid");const s=i.get("tid");const n=i.get("trackingNo")||i.get("tno");const o=i.get("courier")||i.get("c");const e=i.get("orderNo");const r=i.get("plUserId")||i.get("u")||i.get("userId");return{xid:t,trackingId:s,trackingNo:n,courier:o,orderNo:e,userId:r}}async fetchTrackingInfos(i){return this.fetchJSON(`https://api.parcellab.com/v2/checkpoints?${new URLSearchParams(i).toString()}`)}async discoverTrackingId(){var i,t,s,n;if(!this.trackingId){const o=this.getTrackingPropsFromURL();if(o.trackingId)return o.trackingId;if(o.trackingNo&&o.courier||o.orderNo&&o.userId||o.xid&&o.userId){const e=await this.fetchTrackingInfos(new URLSearchParams(o));if((t=(i=e===null||e===void 0?void 0:e.header)===null||i===void 0?void 0:i[0])===null||t===void 0?void 0:t.id)this.trackingId=(n=(s=e===null||e===void 0?void 0:e.header)===null||s===void 0?void 0:s[0])===null||n===void 0?void 0:n.id}}}async fetchJSON(i,t){const n=await fetch(i,t);if(!n.ok){throw new s(`Fetch error: ${n.statusText}`)}const o=await n.json();return o}async fetchBanner(){var i,t,s,n,o,e,r;await this.discoverTrackingId();if(this.trackingId){const a=Object.assign(Object.assign(Object.assign({},this.language&&{language:this.language}),this.medium&&{medium:this.medium}),{trackingId:this.trackingId});const c=new URLSearchParams(Object.assign({},a));const d=await this.fetchJSON(`${this.apiURL}?${c.toString()}`);this._campaign=d;if((s=(t=(i=this._campaign)===null||i===void 0?void 0:i.values)===null||t===void 0?void 0:t[this.contentType])===null||s===void 0?void 0:s[this.bannerType]){const i=(e=(o=(n=this._campaign)===null||n===void 0?void 0:n.values)===null||o===void 0?void 0:o[this.contentType])===null||e===void 0?void 0:e[this.bannerType];this.targetUrl=i.targetUrl||"";this.bannerSrc=((r=i.bannerImage)===null||r===void 0?void 0:r.url)||""}}}render(){return this.bannerSrc&&this.targetUrl?t("a",{href:this.targetUrl,target:"_blank"},t("img",{src:this.bannerSrc,style:{maxWidth:"100%"}})):undefined}};export{n as pl_cm_banner};
//# sourceMappingURL=p-b970f831.entry.js.map